<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>T13_Correlacion</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="custom.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">BIOL 3740</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="Descripción.html">Home</a>
</li>
<li>
  <a href="schedule.html">Calendario</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Instalación y Introducción básica
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Instalar-R-RStudio.html">Instalar R y RStudio</a>
    </li>
    <li>
      <a href="Introducción_RMarkdown.html">RMarkdown</a>
    </li>
    <li>
      <a href="Codigos_basicos_en_R.html">Codigos Básicos en R</a>
    </li>
    <li>
      <a href="R_basico.html">R Básico #2</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Los Temas
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="T1_Intro.html">T1 Introducción a la Estadística</a>
    </li>
    <li>
      <a href="T1a_Poblacion_Muestra.html">T1a Población, Muestreo y Sesgo</a>
    </li>
    <li>
      <a href="T1b_Inferencias_hipotesis.html">T1b Inferencias y hipotesis</a>
    </li>
    <li>
      <a href="T2_Historia.html">T2 Historia breve de la estadística cuantitativa</a>
    </li>
    <li>
      <a href="T3_Medidas_tendencia_central.html">T3 Medidas de Tedencias Central</a>
    </li>
    <li>
      <a href="T4_Medidas_dispersión.html">T4 Medidas de Dispersión</a>
    </li>
    <li>
      <a href="T4a_Estadistica_descriptiva.html">T4a Estadística Descriptiva</a>
    </li>
    <li>
      <a href="T5_Graficos.html">T5 Explorando los datos con gráficos</a>
    </li>
    <li>
      <a href="T6_supuestos.html">T6 Los Supuestos de las pruebas parametricas</a>
    </li>
    <li>
      <a href="T7_Frecuencias.html">T7 Pruebas de Bondad de Ajuste</a>
    </li>
    <li>
      <a href="T8_Distribucion_Normal.html">T8 La Distribución Normal</a>
    </li>
    <li>
      <a href="T13_Correlacion.html">T13 Correlación y Covarianza</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Ejercicios
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Plataforma.html">Ejercico Plataforma de RStudio</a>
    </li>
    <li>
      <a href="RMarkdown.html">Ejercico Plataforma de RMarkdown</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Los Datos
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Archivos_de_Datos.html">Archivos de Datos</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">T13_Correlacion</h1>

</div>


<p>Fecha de la ultima revisión</p>
<pre><code>## [1] &quot;2020-07-27&quot;</code></pre>
<div id="install-packages" class="section level2">
<h2>Install packages</h2>
<p>La correlaciones son métodos para evaluar la relación entre dos o más variables.</p>
<p>Ejemplos</p>
<ol style="list-style-type: decimal">
<li>La cantidad de colesterol, LDL (lipoproteínas de baja densidad) y HDL (lipoproteínas de alta densidad).</li>
<li>La concentración de vitamina C y la absorción de calcio.</li>
<li>La consumo de alcohol y la concentración de alcohol en la sangre.</li>
</ol>
<p>Los analísis se hacen comparando las variables continuas en pares. La covarianza es la medida de variabilidad conjunta entre dos variables.</p>
<p>Primero recordamos la formula para calcular la varianza de una variable</p>
<p><span class="math display">\[s^{ 2 }=\frac { \sum _{ i=1 }^{ n }{ (x_{ i }-\bar { x } ) } ^{ 2 } }{ n-1 }\]</span></p>
<p>Ahora la vamos a descomponer</p>
<p><span class="math display">\[s^{ 2 }=\frac { \sum _{ i=1 }^{ n }{ (x_{ i }-\bar{ x } ) } (x_{ i }-\bar { x } ) }{ n-1 }\]</span></p>
</div>
<div id="correlación-de-pearson" class="section level1">
<h1>Correlación de Pearson</h1>
<p>Esta la más común y conocida como el Coeficiente de correlación de Pearson. Nota ahora que tenemos dos variables <strong>x</strong> y <strong>y</strong>.</p>
<p>Podemos ver cual es la relación entre la edad de los estudiantes y cuantas veces fueron a Disney en Orlando, Florida. El objetivo es evaluar el covarianza entre una variable y otra.</p>
<table>
<thead>
<tr class="header">
<th>Personas</th>
<th>Maria</th>
<th>Juan</th>
<th>José</th>
<th>Carla</th>
<th>Luis</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Edad (x)</td>
<td>8</td>
<td>9</td>
<td>10</td>
<td>13</td>
<td>15</td>
</tr>
<tr class="even">
<td>Veces a Disney (y)</td>
<td>5</td>
<td>4</td>
<td>4</td>
<td>6</td>
<td>8</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th>Personas</th>
<th>Edad (x)</th>
<th>x^2</th>
<th>Veces a Disney (y)</th>
<th>y^2</th>
<th>xy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>María</td>
<td>8</td>
<td>9</td>
<td>10</td>
<td>13</td>
<td>15</td>
</tr>
<tr class="even">
<td>Juan</td>
<td>9</td>
<td>4</td>
<td>4</td>
<td>6</td>
<td>8</td>
</tr>
<tr class="odd">
<td>José</td>
<td>10</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>Carla</td>
<td>13</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>Luis</td>
<td>15</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>Sumas</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>La siguiente formula muestra el calculo para el coeficiente de Pearson <span class="math inline">\(\rho\)</span> que se dice <strong>rho</strong> que es el parámetro (el universo). Para significar el coeficiente de una muestra se usa la <strong>r</strong>.</p>
<p><span class="math display">\[r=\frac { cov(x,y) }{ { s }_{ x }{ s }_{ y } } =\frac { \sum { ({ x }_{ i }-\bar { x } _{ i })({ y }_{ i }-\bar { y } _{ i }) }  }{ n-1({ s }_{ x }{ s }_{ y }) }\]</span> Una otra manera de ver como se calcula el coeficiente es usar la siguiente formula.</p>
<p><span class="math display">\[r=\frac{\sum_{ }^{ }xy-\left(\frac{\sum_{ }^{ }x\sum_{ }^{ }y}{n}\right)}{\sqrt{\left(\sum_{ }^{ }x^2-\frac{\left(\sum_{ }^{ }x\right)^2}{n}\right)\left(\sum_{ }^{ }y^2-\frac{\left(\sum_{ }^{ }y\right)^2}{n}\right)}}\]</span></p>
<p>Creamos un conjunto de datos para demostrar como se calcula</p>
<pre class="r"><code>Edad&lt;-c(8,9,10,13,15)
Disney&lt;-c(5,4,4,6,8)
dfDisney&lt;-data.frame(Edad, Disney) # unir las listas en un data frame
dfDisney$Edad2=dfDisney$Edad^2
dfDisney$Disney2=dfDisney$Disney^2
dfDisney$Edad_por_Disney=dfDisney$Edad*dfDisney$Disney
dfDisney</code></pre>
<pre><code>##   Edad Disney Edad2 Disney2 Edad_por_Disney
## 1    8      5    64      25              40
## 2    9      4    81      16              36
## 3   10      4   100      16              40
## 4   13      6   169      36              78
## 5   15      8   225      64             120</code></pre>
<p>Lo que necesitamos ahora es calcular cada una de las variables</p>
<pre class="r"><code>library(knitr)
library(kableExtra)
df &lt;- data.frame(Formulas = c(&quot;$$\\sum x $$&quot;,&quot;$$\\sum y$$&quot;, &quot;$$\\sum x^2$$&quot;, &quot;$$\\sum y^2$$&quot;, &quot;$$\\sum xy$$&quot;),
                 Sumas = c(55, 27, 639,157, 314))

kable(df, escape=FALSE)</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left;">
Formulas
</th>
<th style="text-align:right;">
Sumas
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<span class="math display">\[\sum x \]</span>
</td>
<td style="text-align:right;">
55
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math display">\[\sum y\]</span>
</td>
<td style="text-align:right;">
27
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math display">\[\sum x^2\]</span>
</td>
<td style="text-align:right;">
639
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math display">\[\sum y^2\]</span>
</td>
<td style="text-align:right;">
157
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math display">\[\sum xy\]</span>
</td>
<td style="text-align:right;">
314
</td>
</tr>
</tbody>
</table>
<p>Ahora sustituir los valores en la ecuación para calcular el coeficiente de Pearson.</p>
<p><span class="math display">\[r=\frac{314-\left(\frac{55\cdot27}{5}\right)}{\sqrt{\left(639-\frac{\left(55\right)^2}{5}\right)\left(157-\frac{\left(27\right)^2}{5}\right)}}=0.871\]</span> La función para hacer todos estos calculo es <strong>cor</strong>. Con una correlación de 0.87, esto significa que hay buena correlación positiva entre la edad y la cantidad de veces que han ido a Disney.</p>
<pre class="r"><code>cor(Edad, Disney)</code></pre>
<pre><code>## [1] 0.8711651</code></pre>
<p>Un gráfico de Correlación sencilla. Miran que parece haber un patrón de cuando aumenta una variable aumenta la otra.</p>
<pre class="r"><code>scatter&lt;-ggplot(dfDisney, aes(x=Edad, y=Disney))
scatter + geom_point(colour=&quot;purple&quot;)+
  geom_hline(aes(yintercept=mean(Disney)))+ # las lineas representa el promedio de la variable en *y* los valores
  geom_vline(aes(xintercept=mean(Edad))) # las lineas representa el promedio de la variable en *x* los valores</code></pre>
<p><img src="T13_Correlacion_files/figure-html/graph%20correlations-1.png" width="60%" style="display: block; margin: auto;" /></p>
</div>
<div id="el-rango-del-coeficiente-pearson" class="section level1">
<h1>El rango del coeficiente Pearson</h1>
<p>El coeficiente de correlación varía de −1 a 1. El valor de 1 implica que la relación entre X e Y es perfecta positiva, en otra palabra la <strong>x</strong> predice exactamente el valor de <strong>y</strong>. Un valor de -1 implica que los datos predicen una relación negativa perfecta entre la <strong>x</strong> y <strong>y</strong>. Cuando el valor de 0 o cerca esto implica que no existe una correlación lineal entre las variables.</p>
<p>Los supuestos del modelo</p>
<ol style="list-style-type: decimal">
<li>Uno de los supuestos de la prueba de análisis de Pearson, es que las dos variables tenga una distribución normal, <strong>Nornal bivariada</strong>.</li>
<li>Las variables tienen que tener una correlación lineal (no por cuadrática o logarítmica).</li>
</ol>
<p>Para visualizar una distribución vea lo siguiente. Nota que ls dos variables tienen una distribución normal.</p>
<p>Este gráfico proviene del siguiente website <a href="http://lertap5.com/RMCS2017/HTML/bivariate-normal.html" class="uri">http://lertap5.com/RMCS2017/HTML/bivariate-normal.html</a></p>
<p><img src="Graficos/Bivariate_normal.png" width="60%" style="display: block; margin: auto;" /></p>
<p>Dealing with missing values use the following function use = “pairwise.complete.obs”.</p>
<div id="kendall-correlation" class="section level2">
<h2>Kendall Correlation</h2>
<p>In statistics, the Kendall rank correlation coefficient, commonly referred to as Kendall’s tau coefficient (after the Greek letter τ), is a statistic used to measure the ordinal association between two measured quantities. A tau test is a non-parametric hypothesis test for statistical dependence based on the tau coefficient.</p>
<p>It is a measure of rank correlation: the similarity of the orderings of the data when ranked by each of the quantities. It is named after Maurice Kendall, who developed it in 1938,[1] though Gustav Fechner had proposed a similar measure in the context of time series in 1897.</p>
<p>Intuitively, the Kendall correlation between two variables will be high when observations have a similar (or identical for a correlation of 1) rank (i.e. relative position label of the observations within the variable: 1st, 2nd, 3rd, etc.) between the two variables, and low when observations have a dissimilar (or fully different for a correlation of -1) rank between the two variables.</p>
</div>
<div id="spearman-correlation" class="section level2">
<h2>Spearman Correlation</h2>
<p>In statistics, Spearman’s rank correlation coefficient or Spearman’s rho, named after Charles Spearman and often denoted by the Greek letter ρ(rho), is a nonparametric measure of rank correlation (statistical dependence between the rankings of two variables). It assesses how well the relationship between two variables can be described using a monotonic function.</p>
<p>The Spearman correlation between two variables is equal to the Pearson correlation between the rank values of those two variables; while Pearson’s correlation assesses linear relationships, Spearman’s correlation assesses monotonic relationships (whether linear or not). If there are no repeated data values, a perfect Spearman correlation of +1 or −1 occurs when each of the variables is a perfect monotone function of the other.</p>
<p>Intuitively, the Spearman correlation between two variables will be high when observations have a similar (or identical for a correlation of 1) rank (i.e. relative position label of the observations within the variable: 1st, 2nd, 3rd, etc.) between the two variables, and low when observations have a dissimilar (or fully opposed for a correlation of −1) rank between the two variables.</p>
</div>
</div>
<div id="the-strenght-of-the-correlation-is-based-on-the-absolute-number" class="section level1">
<h1>THE STRENGHT of the correlation is based on the ABSOLUTE NUMBER</h1>
<p>Using use = “everything”, Si Hay 1 “NA” en la los datos, elimina la variable completa use = “complete.obs”, Si hay 1 “NA”, Elimina el individuo que tiene NA para todas los calculos use = “pairwise.complete.obs”, Si hay un “NA”, Elimina el individuo solamente si el par evaluado tiene un “NA”.</p>
<p>Whereas with use=“pairwise.complete.obs” , the cases with missing values are only removed during the calculation of each pairwise correlation. Thus we see that the correlation between x and z is the same in both matrices but the correlation between y and both x and z depends on the use method (with dramatic effect).</p>
<pre class="r"><code>#-----Dealing with misisng cases

adverts&lt;-c(15,14,14,6,2)
comprasNA&lt;-c(8,9,10,NA,15)
age&lt;-c(5, 12, 16, 9, 14)
advertNA&lt;-data.frame(adverts, comprasNA, age)

head(advertNA)</code></pre>
<pre><code>##   adverts comprasNA age
## 1      15         8   5
## 2      14         9  12
## 3      14        10  16
## 4       6        NA   9
## 5       2        15  14</code></pre>
<pre class="r"><code>cor(advertNA, use = &quot;everything&quot;,  method = &quot;pearson&quot;)</code></pre>
<pre><code>##              adverts comprasNA        age
## adverts    1.0000000        NA -0.2194619
## comprasNA         NA         1         NA
## age       -0.2194619        NA  1.0000000</code></pre>
<pre class="r"><code>cor(advertNA, use = &quot;complete.obs&quot;,  method = &quot;pearson&quot;)</code></pre>
<pre><code>##              adverts  comprasNA        age
## adverts    1.0000000 -0.9794293 -0.3799803
## comprasNA -0.9794293  1.0000000  0.5486947
## age       -0.3799803  0.5486947  1.0000000</code></pre>
<pre class="r"><code>cor(advertNA, use = &quot;pairwise.complete.obs&quot;,  method = &quot;pearson&quot;) # Comunente usado.  </code></pre>
<pre><code>##              adverts  comprasNA        age
## adverts    1.0000000 -0.9794293 -0.2194619
## comprasNA -0.9794293  1.0000000  0.5486947
## age       -0.2194619  0.5486947  1.0000000</code></pre>
<pre class="r"><code>cor(advertNA, use = &quot;pairwise.complete.obs&quot;,  method = &quot;kendall&quot;)   </code></pre>
<pre><code>##              adverts  comprasNA        age
## adverts    1.0000000 -0.9128709 -0.3162278
## comprasNA -0.9128709  1.0000000  0.6666667
## age       -0.3162278  0.6666667  1.0000000</code></pre>
<pre class="r"><code>cor(advertNA, use = &quot;pairwise.complete.obs&quot;,  method = &quot;spearman&quot;) # n= 30 or more</code></pre>
<pre><code>##              adverts  comprasNA        age
## adverts    1.0000000 -0.9486833 -0.4103913
## comprasNA -0.9486833  1.0000000  0.8000000
## age       -0.4103913  0.8000000  1.0000000</code></pre>
<p>Anxiety data</p>
<pre class="r"><code>library(readr)
Exam_Anxiety &lt;- read_csv(&quot;~/Google Drive/Biometry/Biometria 2015/Biometria_2015_RStudio/Data files/Exam_Anxiety.csv&quot;)
examData=Exam_Anxiety
head(examData)</code></pre>
<pre><code>## # A tibble: 6 x 5
##    Code Revise  Exam Anxiety Gender
##   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt; 
## 1     1      4    40    86.3 Male  
## 2     2     11    65    88.7 Female
## 3     3     27    80    70.2 Male  
## 4     4     53    80    61.3 Male  
## 5     5      4    40    89.5 Male  
## 6     6     22    70    60.5 Female</code></pre>
<p>Correlation anaylisis between anxiety, Exam and time for study (revise)</p>
<pre class="r"><code>cor(examData$Exam, examData$Anxiety, use = &quot;complete.obs&quot;,
    method = &#39;pearson&#39;)</code></pre>
<pre><code>## [1] -0.4409934</code></pre>
<pre class="r"><code>examData2 &lt;- examData[, c(&quot;Exam&quot;, &quot;Anxiety&quot;, &quot;Revise&quot;)]
head(examData2)</code></pre>
<pre><code>## # A tibble: 6 x 3
##    Exam Anxiety Revise
##   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;
## 1    40    86.3      4
## 2    65    88.7     11
## 3    80    70.2     27
## 4    80    61.3     53
## 5    40    89.5      4
## 6    70    60.5     22</code></pre>
<pre class="r"><code>cor(examData2)  # range from -1 to + 1</code></pre>
<pre><code>##               Exam    Anxiety     Revise
## Exam     1.0000000 -0.4409934  0.3967207
## Anxiety -0.4409934  1.0000000 -0.7092493
## Revise   0.3967207 -0.7092493  1.0000000</code></pre>
<pre class="r"><code>cor(examData[, c(&quot;Exam&quot;, &quot;Anxiety&quot;, &quot;Revise&quot;)])</code></pre>
<pre><code>##               Exam    Anxiety     Revise
## Exam     1.0000000 -0.4409934  0.3967207
## Anxiety -0.4409934  1.0000000 -0.7092493
## Revise   0.3967207 -0.7092493  1.0000000</code></pre>
<pre class="r"><code>cor(examData2)^2 * 100 # Ranges from 0 to 100  The proportion of the variance explained</code></pre>
<pre><code>##              Exam   Anxiety    Revise
## Exam    100.00000  19.44752  15.73873
## Anxiety  19.44752 100.00000  50.30345
## Revise   15.73873  50.30345 100.00000</code></pre>
<pre class="r"><code>#Coeficiente de determinación</code></pre>
<p>Using the corr.test function</p>
<pre class="r"><code>ggplot(examData2,aes(Revise, Anxiety))+
  geom_point()</code></pre>
<p><img src="T13_Correlacion_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<pre class="r"><code>ggplot(examData,aes(Revise, Exam, colour=Gender))+
  geom_point()</code></pre>
<p><img src="T13_Correlacion_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<pre class="r"><code>cor.test(examData$Anxiety, examData$Exam)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  examData$Anxiety and examData$Exam
## t = -4.938, df = 101, p-value = 3.128e-06
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.5846244 -0.2705591
## sample estimates:
##        cor 
## -0.4409934</code></pre>
<pre class="r"><code>cor.test(examData$Revise, examData$Exam)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  examData$Revise and examData$Exam
## t = 4.3434, df = 101, p-value = 3.343e-05
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.2200938 0.5481602
## sample estimates:
##       cor 
## 0.3967207</code></pre>
<pre class="r"><code>cor.test(examData$Anxiety, examData$Revise)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  examData$Anxiety and examData$Revise
## t = -10.111, df = 101, p-value &lt; 2.2e-16
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.7938168 -0.5977733
## sample estimates:
##        cor 
## -0.7092493</code></pre>
</div>
<div id="bivariate-plot-to-evaluate-the-distribution-of-both-variables" class="section level1">
<h1>Bivariate plot to evaluate the distribution of both variables</h1>
<p><a href="https://deanattali.com/2015/03/29/ggExtra-r-package/" class="uri">https://deanattali.com/2015/03/29/ggExtra-r-package/</a></p>
<p>Remember this code from chapter 5</p>
<pre class="r"><code>library(tidyverse)
a=rnorm(400, 0, 1)
b=rnorm(400, 0, 1.1)
#b=rbeta(400, 3, 1)
df=data.frame(a,b)
head(df)</code></pre>
<pre><code>##            a          b
## 1  0.2875425 -0.4576823
## 2 -0.4593209 -1.5236373
## 3 -1.1204173 -0.3499189
## 4  0.3660040 -0.5170685
## 5  0.6356017  0.6510640
## 6 -0.3673519  2.2258327</code></pre>
<pre class="r"><code>out &lt;- stack(df)
 


ggplot(out, aes(values, colour=ind, fill=ind))+
  geom_histogram()+
  facet_wrap(~ind)</code></pre>
<p><img src="T13_Correlacion_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<pre class="r"><code>library(car)

leveneTest(out$values, out$ind)</code></pre>
<pre><code>## Levene&#39;s Test for Homogeneity of Variance (center = median)
##        Df F value   Pr(&gt;F)   
## group   1  9.8528 0.001758 **
##       798                    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>#install.packages(&quot;ggExtra&quot;, dependencies = TRUE)
library(ggExtra)

p &lt;- ggplot(df, aes(a, b)) + geom_point() + 
  theme_classic()
# add marginal histograms
ggExtra::ggMarginal(p, type = &quot;histogram&quot;)</code></pre>
<p><img src="T13_Correlacion_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>The biggest liar data</p>
<pre class="r"><code>library(ggplot2)
library(readr)
The_Biggest_Liar &lt;- read_csv(&quot;~/Google Drive/Biometry/Biometria 2015/Biometria_2015_RStudio/Data files/The Biggest Liar.csv&quot;)

liarData=The_Biggest_Liar 
liarData</code></pre>
<pre><code>## # A tibble: 68 x 3
##    Creativity Position Novice
##         &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;
##  1         53        1      0
##  2         36        3      1
##  3         31        4      0
##  4         43        2      0
##  5         30        4      1
##  6         41        1      0
##  7         32        4      0
##  8         54        1      1
##  9         47        2      1
## 10         50        2      0
## # … with 58 more rows</code></pre>
<pre class="r"><code>length(liarData$Creativity)</code></pre>
<pre><code>## [1] 68</code></pre>
<pre class="r"><code>summary(liarData)</code></pre>
<pre><code>##    Creativity       Position         Novice      
##  Min.   :21.00   Min.   :1.000   Min.   :0.0000  
##  1st Qu.:35.00   1st Qu.:1.000   1st Qu.:0.0000  
##  Median :39.00   Median :2.000   Median :1.0000  
##  Mean   :39.99   Mean   :2.221   Mean   :0.5147  
##  3rd Qu.:45.25   3rd Qu.:3.000   3rd Qu.:1.0000  
##  Max.   :56.00   Max.   :6.000   Max.   :1.0000</code></pre>
<p>Como cambiar el nombre de la variables</p>
<pre class="r"><code>names(liarData)</code></pre>
<pre><code>## [1] &quot;Creativity&quot; &quot;Position&quot;   &quot;Novice&quot;</code></pre>
<pre class="r"><code>names(liarData)[1]=paste(&quot;Creatividad&quot;)  # se cambia el nombre de la columna
names(liarData)</code></pre>
<pre><code>## [1] &quot;Creatividad&quot; &quot;Position&quot;    &quot;Novice&quot;</code></pre>
<pre class="r"><code>names(liarData)[2]=paste(&quot;Posición&quot;)
names(liarData)[3]=paste(&quot;Principiante&quot;)
head(liarData)</code></pre>
<pre><code>## # A tibble: 6 x 3
##   Creatividad Posición Principiante
##         &lt;dbl&gt;    &lt;dbl&gt;        &lt;dbl&gt;
## 1          53        1            0
## 2          36        3            1
## 3          31        4            0
## 4          43        2            0
## 5          30        4            1
## 6          41        1            0</code></pre>
<p>Evaluar si las variables tienen distribución normal</p>
<pre class="r"><code>p &lt;- ggplot(liarData, aes(Creatividad, Posición)) + 
  geom_point() + 
  theme_classic()
p
# add marginal histograms
ggExtra::ggMarginal(p, type = &quot;histogram&quot;)</code></pre>
<p><img src="T13_Correlacion_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<pre class="r"><code>ggplot(liarData, aes(Posición))+ 
  geom_histogram(fill=&quot;blue&quot;, colour=&quot;white&quot;)</code></pre>
<p><img src="T13_Correlacion_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<pre class="r"><code>ggplot(liarData, aes(Creatividad))+
  geom_histogram()</code></pre>
<p><img src="T13_Correlacion_files/figure-html/unnamed-chunk-11-2.png" width="672" /></p>
<p>Spearman Correlations</p>
<pre class="r"><code>library(knitr)
library(png)

img4_path&lt;-&quot;Graficos/Stanton.png&quot;
include_graphics(img4_path)</code></pre>
<p><img src="Graficos/Stanton.png" width="500px" /></p>
<pre class="r"><code>#-------Spearman correlation-----Use when data are not normal, 
# such as ordinal data

cor(liarData$Posición, liarData$Creatividad, method = &quot;spearman&quot;)</code></pre>
<pre><code>## [1] -0.3732184</code></pre>
<pre class="r"><code>cor.test(liarData$Posición, liarData$Creatividad, method = &quot;spearman&quot;)</code></pre>
<pre><code>## 
##  Spearman&#39;s rank correlation rho
## 
## data:  liarData$Posición and liarData$Creatividad
## S = 71948, p-value = 0.00172
## alternative hypothesis: true rho is not equal to 0
## sample estimates:
##        rho 
## -0.3732184</code></pre>
<pre class="r"><code>cor.test(liarData$Posición, liarData$Creatividad, alternative = &quot;less&quot;, method = &quot;kendall&quot;)</code></pre>
<pre><code>## 
##  Kendall&#39;s rank correlation tau
## 
## data:  liarData$Posición and liarData$Creatividad
## z = -3.2252, p-value = 0.0006294
## alternative hypothesis: true tau is less than 0
## sample estimates:
##        tau 
## -0.3002413</code></pre>
<pre class="r"><code>ggplot(liarData,aes(Posición, Creatividad))+
  geom_point()</code></pre>
<p><img src="T13_Correlacion_files/figure-html/Spearman-1.png" width="672" /></p>
<pre class="r"><code>ggplot(liarData, aes(Posición, Creatividad))+
  geom_point()</code></pre>
<p><img src="T13_Correlacion_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>Another alternative</p>
<pre class="r"><code>library(Hmisc)  # for the function rcorr
liarMatrix&lt;-as.matrix(liarData[, c(&quot;Posición&quot;, &quot;Creatividad&quot;, &quot;Principiante&quot;)])

rcorr(liarMatrix, type=c(&quot;spearman&quot;)) # si no pone nada asume distribución normal y usa Pearson</code></pre>
<pre><code>##              Posición Creatividad Principiante
## Posición         1.00       -0.37         0.11
## Creatividad     -0.37        1.00        -0.27
## Principiante     0.11       -0.27         1.00
## 
## n= 68 
## 
## 
## P
##              Posición Creatividad Principiante
## Posición              0.0017      0.3777      
## Creatividad  0.0017               0.0281      
## Principiante 0.3777   0.0281</code></pre>
<pre class="r"><code>#--------Kendall&#39;s Tau----------Use with small sample size with tied ranks
# use &quot;less&quot; or &quot;greater&quot;, depending if you 
# predict that the correlation will be less or greater than zero

#cor(liarData$Posición, liarData$Creatividad, method = &quot;kendall&quot;)
#cor.test(liarData$Posición, liarData$Creatividad, alternative = &quot;less&quot;, method = &quot;kendall&quot;)</code></pre>
<pre class="r"><code>ggplot(examData, aes(Exam))+
         geom_histogram()</code></pre>
<p><img src="T13_Correlacion_files/figure-html/hist%20anxiety-1.png" width="672" /></p>
<pre class="r"><code>ggplot(examData, aes(Anxiety))+
         geom_histogram()</code></pre>
<p><img src="T13_Correlacion_files/figure-html/hist%20anxiety-2.png" width="672" /></p>
<pre class="r"><code>cor.test(examData$Anxiety, examData$Exam, method = &quot;kendall&quot;)</code></pre>
<pre><code>## 
##  Kendall&#39;s rank correlation tau
## 
## data:  examData$Anxiety and examData$Exam
## z = -4.113, p-value = 3.906e-05
## alternative hypothesis: true tau is not equal to 0
## sample estimates:
##        tau 
## -0.2847919</code></pre>
<pre class="r"><code>ggplot(examData, aes(Anxiety, Exam))+
  geom_point()</code></pre>
<p><img src="T13_Correlacion_files/figure-html/kendall%20exam%20anxiety-1.png" width="672" /></p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
