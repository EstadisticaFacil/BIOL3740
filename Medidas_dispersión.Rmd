---
title: "Medidas de disperción"
output: 
  html_document:
    toc: yes
    toc_float: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning=FALSE, message = FALSE)
```

Fecha de la ultima revisión
```{r echo=FALSE}

Sys.Date()
```

```{r}
library(ggplot2)
library(Hmisc)
```


***

# Que es la dispersión en estadística


Las medidas o indices de dispersión, son indicadores de cuan variable los datos son uno del otro. Si todos los valores tienen el mismo valor no hay dispersión.  Hay múltiples indices de dispersión vamos a evaluar solamente algunos de estos indices, para más información pueden ir al siguiente enlace <https://en.wikipedia.org/wiki/Statistical_dispersion>.  

Los indices que estaremos estudiando son los siguientes

  - el rango
  - la varianza
  - la desviación estándar
  - el error estándar.
 
 
# Vizualizando la dispersión 
  
Primero miramos un gráfico donde tenemos datos donde el promedio es igual pero la dispersiones son diferentes. Lo que uno observa es que en la distribución azul los datos son más similares uno al otro y la distribución roja los valores son más diferentes.  


```{r}

set.seed(869870) # esto es para que los valores se queda igual a cada vez que se corre el analisis
a=rnorm(5000, 100, 10)
a=data.frame(a)
b=rnorm(5000, 100, 30)
b=data.frame(b)
```


```{r}
ggplot(a, aes(a))+
  geom_density(fill="blue", alpha=.5)+
  geom_density(b, mapping=aes(b,fill="red", alpha=.5 ))+
  theme(legend.position = "none") +
  geom_vline(aes(xintercept = 100, colour="red"))
```

***

# El rango

El rango son los valores mínimo y valor máximo de un conjunto de datos.  Se usa la función **range()**.  Usamos los dos conjuntos de datos ya creado anteriomente para visualizar los rangos de la distribuciones de los gráficos. Lo que uno observa es que el valor mínimo del primer conjunto de datos es 59.17 y el máximo es 137.12.  Para el segundo conjunto de datos el valor mínimo es 1.86 y el máximo es 203.88.  


```{r}
range(a$a)
range(b$b)

```


## La varianza

Los pasos para calcular la varianza son los siguientes

1. tener un conjunto de datos, aquí lo llamamos **Data**
2. convertir esta lista en un data frame 
3. Calcular el promedio de los datos
4. restar el promedio de cada valor y cuadralos
5. Sumar y restas de **n-1**, done **n** es la cantidad de datos



$${ s }^{ 2 }=\frac { \sum { { ({ x }_{ i }-\bar { x }  })^{ 2 } }  }{ n-1 }$$

```{r}
library(tidyverse)
Data=c(1,2,3,4,5,6)
Data_df=data.frame(Data)
Data_df
Data_df$mean_Data=mean(Data)   # here we add the mean to each row
Data_df
Data_df$Diff=Data_df$Data-Data_df$mean_Data 
          # calculate the difference between the data and the mean
sum(Data_df$Diff) # si los valores no se cuadra la suma sera zero.

Data_df$SS=(Data_df$Data-Data_df$mean_Data)^2 # SS para la suma de los cuadrados 
Data_df
sum(Data_df$SS)
 #  This is called the Deviation "from the mean"
```
## Calcular la varianza con **var()**

Ahora la manera fácil de hacer los análisis, usar la función **var**, y no hay que hacer ninguno de los pasos anteriores.   Pero es importante que sepa como es el procedimiento de calcular la varianza. Nota que la varianza es un indice de la diferencia entre el promedio y y cada valor/  El otro paso es que los valores tienen que estar cuadrada las diferencias sino la suma sera de cero.    

```{r}
var(Data)
```

*** 


# La desviación estandar

La varianza es un indice que no esta en la misma unidad que los valores recolectado, por ejemplo si se recolecta los datos en centímetros, la varianza es en centímetros cuadrados. Por consecuencia no es necesariamente el mejor para describir la dispersión. Entonces hay que sacar la raíz cuadra de la varianza. 
  
  $${ s }=\sqrt { \frac { \sum { { ({ x }_{ i }-\bar { x }  })^{ 2 } }  }{ n-1 }  }$$ 
  o más sencillo
  
  $$\sqrt{s^2}$$
  
la función **sd**, "standard deviation" es sumamente facil de calcular en R. 



```{r}
sd(Data_df$Data)  # deviación estandard
```

***

# El rango intertcuartil.

La función básica es **quantile** si lo dejamos sin más instrucción calcula los siguientes probabilidades 0%, 25%, 50% (mediana), 75%, 100%.  Pero si uno quiere los valores que se encuentra en una posición especifica hay que usar **type =1** como se ve en el segundo ejemplo.  Hay 9 tipos de cuantiles con esta función, estos se encuentra definido en RStudio. Añade **quantile** en el artea de **help** y vera las otras alternativas.   

```{r}
quantile(Data) # la función básica (0%, 25%, 50% (mediana), 75%, 100%)

# Seleccionar los cuantiles específicos.
quantile(Data, probs = c(0.015, 0.25, 0.50,.75, .975))   
```


Para explicar estos conceptos mejor visualizamos los datos 


| i  | x[i]  | Mediana | Quartiles   |
|----|-------:|:---------:|:-------------:|
| 1  | 03    |           |  |
| 2  | 19     |           |          |
| 3  | 27      |         |             |
| 4  | 33    |         |    Q1=33         |
| 5  | 52    |         |             |
| 6  | 60    |         |            |
| 7  | 77    |         |             |
| 8  | 87    |  Q2=87       |             |
| 9  | 99    |       |             |
| 10 | 101   |         |             |
| 11 | 122   |         |             |
| 12 | 137   |         | Q3=137    |
| 13 | 140   |         |             |
| 14 | 142   |         |             |
| 15 | 150   |         |             |

Ahora usamos la función **quantile** con el type=1 de calcular los cuartiles y vermos si tenemos los mismos resultados.  
```{r}

dat=c(3,19,27,33,52,60,77,87,99,101,122,137,140,142,150)

quantile(dat, type =1)



```


***




```{r}
library(readr)
Exam_Anxiety <- read_csv("Data_files_csv/Exam Anxiety.csv")
```

Para visualizar las primeras y ultimas 6 filas usar **head()** y **tail()** respectivamente.  

```{r}
head(Exam_Anxiety)
tail(Exam_Anxiety)
```


```{r}
mean(Exam_Anxiety$Revise)
range(Exam_Anxiety$Revise)
```



```{r}
y=rnorm(1001)


quantile(y)
probs = c(0.01, 0.10, 0.50,.90)
```